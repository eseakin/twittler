<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" type="text/css" href="style.css">
    <script src="jquery.js"></script>
    <script src="data_generator.js"></script>
    <link rel='shortcut icon' href="favicon.ico" type='image/x-icon' />
    <link href="https://fonts.googleapis.com/css?family=Lobster" rel="stylesheet">
    <title>Twittler</title>
  </head>
  <body>
    <div id="titlebar">
      <div id="navbar">
        <ul id="navlist">
          <li><a href="#">Home</a></li>
          <li><a href="#">Notifications</a></li>
          <li><a href="#">Messages</a></li>
          <li><a href="#">Profile</a></li>
        </ul>
      </div>

      <div id="title"><img src="img/twittlerlogo.png"/>Twittler</div>
      <div id="instructions">Click to filter, click again to undo.</div>
    </div>



    <div id="feed"></div>

    <script>
      var filterCheck = undefined;

      var weekday = ["Sun","Mon","Tues","Wed",",Thurs","Fri","Sat"];

      $(document).ready(function(){
        var $feed = $('#feed');
        $feed.html('');
        var index = 0;





       setInterval(function(){
          for(index;index < streams.home.length; index++){
            var tweet = streams.home[index];
            var $tweet = $('<div class="tweet" id='+index+' style="display:none;"></div>');

            //timestamp

            var date = new Date();
            var timestamp = '';
            var minutes = date.getMinutes();
            if(minutes < 10)
              minutes = "0"+minutes;

            var hours = date.getHours();
            if(hours === 0)
              hours = 12;

            if(date.getHours() > 12){
              timestamp = weekday[date.getDay()] + ", " + date.getHours()-12 + ":" + minutes + "pm";
            }else{
              timestamp = weekday[date.getDay()] + ", " + hours + ":" + minutes + "am";
            }
            //add timestamp to date block
            var $date = $('<div class="date" style="display:none"</div>');
            $date.text(timestamp);

            //tweets
            $tweet.text('@' + tweet.user + ': ' + tweet.message);
            $tweet.addClass(tweet.user)

            //alternating color scheme
            index % 2 === 0 ? $tweet.addClass("tweetbg1") : $tweet.addClass("tweetbg2");

            //filter new tweets as they are created
            if(filterCheck === undefined){
              $tweet.prependTo($feed).slideDown();
              $date.appendTo($tweet).slideDown();
            }else{
              if(filterCheck === tweet.user){
                $tweet.prependTo($feed).slideDown();
                $date.appendTo($tweet).slideDown();
              }else{
                $tweet.prependTo($feed);
                $date.appendTo($tweet);
              }
            }

            //add click event
            $('#'+index).click(function(){
              //console.log("click added to "+this.id);
              if(this.classList.contains("shawndrost")){
                classFilter("shawndrost");
              }else if(this.classList.contains("mracus")){
                classFilter("mracus");
              }else if(this.classList.contains("sharksforcheap")){
                classFilter("sharksforcheap");
              }else if(this.classList.contains("douglascalhoun")){
                classFilter("douglascalhoun");
              }

            });

          }
       },500);

      });

      //onclick function to filter by username
      function classFilter(classIn){
        console.log("classin ",classIn);
        console.log("filter ",filterCheck);
        if(filterCheck === undefined){
          filterCheck = classIn;
          $('.tweet').not('.'+classIn).slideUp();

        }else{
          filterCheck = undefined;
          classIn = '.'+classIn;
          $('.tweet').slideDown();
        }

      }

    </script>
  </body>
</html>
